/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/transformers/training_args.py:1559: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/transformers/training_args.py:1559: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/transformers/training_args.py:1559: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/transformers/training_args.py:1559: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead  warnings.warn(Loading checkpoint shards:   0%|                                                                                                                                                                                                    | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                                                                                                                    | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|                                                                                                                                                                                                    | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|██████▎                                                                                                                                                                                     | 1/30 [00:00<00:23,  1.21it/s]Loading checkpoint shards:   3%|██████▎                                                                                                                                                                                     | 1/30 [00:00<00:18,  1.55it/s]Loading checkpoint shards:   3%|██████▎                                                                                                                                                                                     | 1/30 [00:00<00:19,  1.46it/s]Loading checkpoint shards:   7%|████████████▌                                                                                                                                                                               | 2/30 [00:01<00:25,  1.10it/s]Loading checkpoint shards:   7%|████████████▌                                                                                                                                                                               | 2/30 [00:01<00:23,  1.19it/s]Loading checkpoint shards:   0%|                                                                                                                                                                                                    | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   7%|████████████▌                                                                                                                                                                               | 2/30 [00:01<00:24,  1.17it/s]Loading checkpoint shards:   3%|██████▎                                                                                                                                                                                     | 1/30 [00:00<00:18,  1.54it/s]Loading checkpoint shards:  10%|██████████████████▊                                                                                                                                                                         | 3/30 [00:03<00:35,  1.31s/it]Loading checkpoint shards:  10%|██████████████████▊                                                                                                                                                                         | 3/30 [00:03<00:35,  1.30s/it]Loading checkpoint shards:  10%|██████████████████▊                                                                                                                                                                         | 3/30 [00:03<00:30,  1.12s/it]Loading checkpoint shards:   7%|████████████▌                                                                                                                                                                               | 2/30 [00:01<00:24,  1.12it/s]Loading checkpoint shards:  13%|█████████████████████████                                                                                                                                                                   | 4/30 [00:04<00:31,  1.20s/it]Loading checkpoint shards:  13%|█████████████████████████                                                                                                                                                                   | 4/30 [00:04<00:31,  1.19s/it]Loading checkpoint shards:  13%|█████████████████████████                                                                                                                                                                   | 4/30 [00:04<00:28,  1.09s/it]Loading checkpoint shards:  10%|██████████████████▊                                                                                                                                                                         | 3/30 [00:02<00:27,  1.01s/it]Loading checkpoint shards:  17%|███████████████████████████████▎                                                                                                                                                            | 5/30 [00:05<00:27,  1.11s/it]Loading checkpoint shards:  17%|███████████████████████████████▎                                                                                                                                                            | 5/30 [00:05<00:27,  1.09s/it]Loading checkpoint shards:  17%|███████████████████████████████▎                                                                                                                                                            | 5/30 [00:05<00:26,  1.05s/it]Loading checkpoint shards:  13%|█████████████████████████                                                                                                                                                                   | 4/30 [00:03<00:27,  1.05s/it]Loading checkpoint shards:  20%|█████████████████████████████████████▌                                                                                                                                                      | 6/30 [00:06<00:24,  1.04s/it]Loading checkpoint shards:  20%|█████████████████████████████████████▌                                                                                                                                                      | 6/30 [00:06<00:24,  1.00s/it]Loading checkpoint shards:  20%|█████████████████████████████████████▌                                                                                                                                                      | 6/30 [00:06<00:25,  1.05s/it]Loading checkpoint shards:  17%|███████████████████████████████▎                                                                                                                                                            | 5/30 [00:04<00:25,  1.01s/it]Loading checkpoint shards:  23%|███████████████████████████████████████████▊                                                                                                                                                | 7/30 [00:07<00:22,  1.02it/s]Loading checkpoint shards:  23%|███████████████████████████████████████████▊                                                                                                                                                | 7/30 [00:07<00:21,  1.05it/s]Loading checkpoint shards:  20%|█████████████████████████████████████▌                                                                                                                                                      | 6/30 [00:05<00:22,  1.05it/s]Loading checkpoint shards:  23%|███████████████████████████████████████████▊                                                                                                                                                | 7/30 [00:07<00:25,  1.12s/it]Loading checkpoint shards:  27%|██████████████████████████████████████████████████▏                                                                                                                                         | 8/30 [00:07<00:20,  1.08it/s]Loading checkpoint shards:  27%|██████████████████████████████████████████████████▏                                                                                                                                         | 8/30 [00:08<00:21,  1.04it/s]Loading checkpoint shards:  23%|███████████████████████████████████████████▊                                                                                                                                                | 7/30 [00:06<00:21,  1.09it/s]Loading checkpoint shards:  30%|████████████████████████████████████████████████████████▍                                                                                                                                   | 9/30 [00:08<00:19,  1.09it/s]Loading checkpoint shards:  30%|████████████████████████████████████████████████████████▍                                                                                                                                   | 9/30 [00:09<00:19,  1.05it/s]Loading checkpoint shards:  27%|██████████████████████████████████████████████████▏                                                                                                                                         | 8/30 [00:08<00:24,  1.12s/it]Loading checkpoint shards:  27%|██████████████████████████████████████████████████▏                                                                                                                                         | 8/30 [00:07<00:20,  1.09it/s]Loading checkpoint shards:  33%|██████████████████████████████████████████████████████████████▎                                                                                                                            | 10/30 [00:09<00:18,  1.11it/s]Loading checkpoint shards:  33%|██████████████████████████████████████████████████████████████▎                                                                                                                            | 10/30 [00:10<00:18,  1.07it/s]Loading checkpoint shards:  30%|████████████████████████████████████████████████████████▍                                                                                                                                   | 9/30 [00:09<00:23,  1.11s/it]Loading checkpoint shards:  30%|████████████████████████████████████████████████████████▍                                                                                                                                   | 9/30 [00:08<00:18,  1.12it/s]Loading checkpoint shards:  37%|████████████████████████████████████████████████████████████████████▌                                                                                                                      | 11/30 [00:10<00:17,  1.07it/s]Loading checkpoint shards:  37%|████████████████████████████████████████████████████████████████████▌                                                                                                                      | 11/30 [00:11<00:18,  1.05it/s]Loading checkpoint shards:  33%|██████████████████████████████████████████████████████████████▎                                                                                                                            | 10/30 [00:10<00:21,  1.09s/it]Loading checkpoint shards:  33%|██████████████████████████████████████████████████████████████▎                                                                                                                            | 10/30 [00:09<00:17,  1.14it/s]Loading checkpoint shards:  40%|██████████████████████████████████████████████████████████████████████████▊                                                                                                                | 12/30 [00:11<00:17,  1.05it/s]Loading checkpoint shards:  40%|██████████████████████████████████████████████████████████████████████████▊                                                                                                                | 12/30 [00:12<00:17,  1.05it/s]Loading checkpoint shards:  37%|████████████████████████████████████████████████████████████████████▌                                                                                                                      | 11/30 [00:11<00:19,  1.01s/it]Loading checkpoint shards:  37%|████████████████████████████████████████████████████████████████████▌                                                                                                                      | 11/30 [00:10<00:17,  1.08it/s]Loading checkpoint shards:  43%|█████████████████████████████████████████████████████████████████████████████████                                                                                                          | 13/30 [00:12<00:16,  1.05it/s]Loading checkpoint shards:  43%|█████████████████████████████████████████████████████████████████████████████████                                                                                                          | 13/30 [00:12<00:16,  1.04it/s]Loading checkpoint shards:  40%|██████████████████████████████████████████████████████████████████████████▊                                                                                                                | 12/30 [00:12<00:17,  1.00it/s]Loading checkpoint shards:  40%|██████████████████████████████████████████████████████████████████████████▊                                                                                                                | 12/30 [00:11<00:16,  1.07it/s]Loading checkpoint shards:  47%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                   | 14/30 [00:13<00:15,  1.03it/s]Loading checkpoint shards:  47%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                   | 14/30 [00:13<00:15,  1.02it/s]Loading checkpoint shards:  43%|█████████████████████████████████████████████████████████████████████████████████                                                                                                          | 13/30 [00:13<00:17,  1.01s/it]Loading checkpoint shards:  43%|█████████████████████████████████████████████████████████████████████████████████                                                                                                          | 13/30 [00:12<00:16,  1.06it/s]Loading checkpoint shards:  50%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                             | 15/30 [00:14<00:14,  1.03it/s]Loading checkpoint shards:  50%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                             | 15/30 [00:14<00:14,  1.02it/s]Loading checkpoint shards:  47%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                   | 14/30 [00:14<00:15,  1.02it/s]Loading checkpoint shards:  47%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                   | 14/30 [00:13<00:15,  1.03it/s]Loading checkpoint shards:  53%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 16/30 [00:15<00:13,  1.03it/s]Loading checkpoint shards:  53%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 16/30 [00:15<00:13,  1.02it/s]Loading checkpoint shards:  50%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                             | 15/30 [00:15<00:14,  1.05it/s]Loading checkpoint shards:  50%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                             | 15/30 [00:14<00:14,  1.02it/s]Loading checkpoint shards:  53%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 16/30 [00:16<00:12,  1.09it/s]Loading checkpoint shards:  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                 | 17/30 [00:16<00:12,  1.03it/s]Loading checkpoint shards:  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                 | 17/30 [00:16<00:12,  1.01it/s]Loading checkpoint shards:  53%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 16/30 [00:15<00:13,  1.02it/s]Loading checkpoint shards:  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                 | 17/30 [00:17<00:11,  1.11it/s]Loading checkpoint shards:  60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                          | 18/30 [00:17<00:11,  1.01it/s]Loading checkpoint shards:  60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                          | 18/30 [00:17<00:12,  1.02s/it]Loading checkpoint shards:  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                 | 17/30 [00:16<00:12,  1.01it/s]Loading checkpoint shards:  60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                          | 18/30 [00:17<00:10,  1.11it/s]Loading checkpoint shards:  63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 19/30 [00:18<00:11,  1.01s/it]Loading checkpoint shards:  63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 19/30 [00:18<00:11,  1.02s/it]Loading checkpoint shards:  60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                          | 18/30 [00:17<00:11,  1.00it/s]Loading checkpoint shards:  63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 19/30 [00:18<00:09,  1.12it/s]Loading checkpoint shards:  67%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 20/30 [00:19<00:10,  1.00s/it]Loading checkpoint shards:  67%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 20/30 [00:19<00:10,  1.01s/it]Loading checkpoint shards:  67%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 20/30 [00:19<00:08,  1.14it/s]Loading checkpoint shards:  63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 19/30 [00:18<00:11,  1.00s/it]Loading checkpoint shards:  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                        | 21/30 [00:20<00:08,  1.02it/s]Loading checkpoint shards:  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                        | 21/30 [00:20<00:08,  1.03it/s]Loading checkpoint shards:  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                        | 21/30 [00:20<00:08,  1.09it/s]Loading checkpoint shards:  67%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 20/30 [00:19<00:09,  1.02it/s]Loading checkpoint shards:  73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 22/30 [00:21<00:07,  1.04it/s]Loading checkpoint shards:  73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 22/30 [00:21<00:07,  1.05it/s]Loading checkpoint shards:  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                        | 21/30 [00:20<00:08,  1.04it/s]Loading checkpoint shards:  73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 22/30 [00:21<00:07,  1.05it/s]Loading checkpoint shards:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                           | 23/30 [00:22<00:06,  1.03it/s]Loading checkpoint shards:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                           | 23/30 [00:22<00:06,  1.04it/s]Loading checkpoint shards:  73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 22/30 [00:20<00:07,  1.06it/s]Loading checkpoint shards:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                           | 23/30 [00:22<00:06,  1.04it/s]Loading checkpoint shards:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                     | 24/30 [00:23<00:05,  1.03it/s]Loading checkpoint shards:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                     | 24/30 [00:23<00:05,  1.04it/s]Loading checkpoint shards:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                           | 23/30 [00:21<00:06,  1.05it/s]Loading checkpoint shards:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                     | 24/30 [00:23<00:05,  1.01it/s]Loading checkpoint shards:  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 25/30 [00:24<00:04,  1.06it/s]Loading checkpoint shards:  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 25/30 [00:24<00:04,  1.08it/s]Loading checkpoint shards:  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                     | 24/30 [00:22<00:05,  1.06it/s]Loading checkpoint shards:  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 25/30 [00:24<00:05,  1.01s/it]Loading checkpoint shards:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 26/30 [00:25<00:03,  1.11it/s]Loading checkpoint shards:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 26/30 [00:25<00:03,  1.09it/s]Loading checkpoint shards:  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 25/30 [00:23<00:04,  1.09it/s]Loading checkpoint shards:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 27/30 [00:26<00:02,  1.11it/s]Loading checkpoint shards:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 27/30 [00:26<00:02,  1.12it/s]Loading checkpoint shards:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 26/30 [00:25<00:04,  1.03s/it]Loading checkpoint shards:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 26/30 [00:24<00:03,  1.13it/s]Loading checkpoint shards:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 28/30 [00:27<00:01,  1.12it/s]Loading checkpoint shards:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 28/30 [00:27<00:01,  1.10it/s]Loading checkpoint shards:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 27/30 [00:26<00:03,  1.03s/it]Loading checkpoint shards:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 27/30 [00:25<00:02,  1.13it/s]Loading checkpoint shards:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 29/30 [00:27<00:00,  1.13it/s]Loading checkpoint shards:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 29/30 [00:28<00:00,  1.11it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:27<00:00,  1.53it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:27<00:00,  1.07it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:28<00:00,  1.50it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:28<00:00,  1.06it/s]Loading checkpoint shards:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 28/30 [00:26<00:01,  1.12it/s]Loading checkpoint shards:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 28/30 [00:27<00:02,  1.05s/it]Loading checkpoint shards:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 29/30 [00:27<00:00,  1.16it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:27<00:00,  1.57it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:27<00:00,  1.10it/s]Loading checkpoint shards:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 29/30 [00:29<00:01,  1.06s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:29<00:00,  1.29it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:29<00:00,  1.03it/s]Size of the train set: 72933. Size of the validation set: 3839A sample of train dataset: {'content': "Instruction: What is the sentiment of this news? Please choose an answer from {strong negative/moderately negative/mildly negative/neutral/mildly positive/moderately positive/strong positive}.\nInput: Google owner Alphabet Inc (NASDAQ:GOOG) and iHeartMedia Inc have\xa0reached a settlement with the US Federal Trade Commission (FTC) and seven US\xa0states over allegations of deceptive advertising\xa0promoting Google's Pixel 4 smartphone. In a\xa0statement\xa0on Monday, the FTC said that the two companies aired nearly 29,000 deceptive endorsements by radio personalities promoting their use of and experience with Google's Pixel 4 phone in 2019 and 2020.\nAnswer: moderately negative"}/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/huggingface_hub/utils/_deprecation.py:100: FutureWarning: Deprecated argument(s) used in '__init__': packing, dataset_kwargs, dataset_text_field, max_seq_length. Will not be supported from version '0.13.0'.Deprecated positional argument(s) used in SFTTrainer, please use the SFTConfig to set these arguments instead.  warnings.warn(message, FutureWarning)/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/transformers/training_args.py:1559: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:212: UserWarning: You passed a `packing` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:300: UserWarning: You passed a `max_seq_length` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:328: UserWarning: You passed a `dataset_text_field` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:334: UserWarning: You passed a `dataset_kwargs` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(Size of the train set: 72933. Size of the validation set: 3839A sample of train dataset: {'content': "Instruction: What is the sentiment of this news? Please choose an answer from {strong negative/moderately negative/mildly negative/neutral/mildly positive/moderately positive/strong positive}.\nInput: Google owner Alphabet Inc (NASDAQ:GOOG) and iHeartMedia Inc have\xa0reached a settlement with the US Federal Trade Commission (FTC) and seven US\xa0states over allegations of deceptive advertising\xa0promoting Google's Pixel 4 smartphone. In a\xa0statement\xa0on Monday, the FTC said that the two companies aired nearly 29,000 deceptive endorsements by radio personalities promoting their use of and experience with Google's Pixel 4 phone in 2019 and 2020.\nAnswer: moderately negative"}/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/huggingface_hub/utils/_deprecation.py:100: FutureWarning: Deprecated argument(s) used in '__init__': packing, dataset_kwargs, dataset_text_field, max_seq_length. Will not be supported from version '0.13.0'.Deprecated positional argument(s) used in SFTTrainer, please use the SFTConfig to set these arguments instead.  warnings.warn(message, FutureWarning)/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/transformers/training_args.py:1559: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:212: UserWarning: You passed a `packing` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(Size of the train set: 72933. Size of the validation set: 3839A sample of train dataset: {'content': "Instruction: What is the sentiment of this news? Please choose an answer from {strong negative/moderately negative/mildly negative/neutral/mildly positive/moderately positive/strong positive}.\nInput: Google owner Alphabet Inc (NASDAQ:GOOG) and iHeartMedia Inc have\xa0reached a settlement with the US Federal Trade Commission (FTC) and seven US\xa0states over allegations of deceptive advertising\xa0promoting Google's Pixel 4 smartphone. In a\xa0statement\xa0on Monday, the FTC said that the two companies aired nearly 29,000 deceptive endorsements by radio personalities promoting their use of and experience with Google's Pixel 4 phone in 2019 and 2020.\nAnswer: moderately negative"}/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/huggingface_hub/utils/_deprecation.py:100: FutureWarning: Deprecated argument(s) used in '__init__': packing, dataset_kwargs, dataset_text_field, max_seq_length. Will not be supported from version '0.13.0'.Deprecated positional argument(s) used in SFTTrainer, please use the SFTConfig to set these arguments instead.  warnings.warn(message, FutureWarning)/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/transformers/training_args.py:1559: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:212: UserWarning: You passed a `packing` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(Size of the train set: 72933. Size of the validation set: 3839A sample of train dataset: {'content': "Instruction: What is the sentiment of this news? Please choose an answer from {strong negative/moderately negative/mildly negative/neutral/mildly positive/moderately positive/strong positive}.\nInput: Google owner Alphabet Inc (NASDAQ:GOOG) and iHeartMedia Inc have\xa0reached a settlement with the US Federal Trade Commission (FTC) and seven US\xa0states over allegations of deceptive advertising\xa0promoting Google's Pixel 4 smartphone. In a\xa0statement\xa0on Monday, the FTC said that the two companies aired nearly 29,000 deceptive endorsements by radio personalities promoting their use of and experience with Google's Pixel 4 phone in 2019 and 2020.\nAnswer: moderately negative"}/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/huggingface_hub/utils/_deprecation.py:100: FutureWarning: Deprecated argument(s) used in '__init__': packing, dataset_kwargs, dataset_text_field, max_seq_length. Will not be supported from version '0.13.0'.Deprecated positional argument(s) used in SFTTrainer, please use the SFTConfig to set these arguments instead.  warnings.warn(message, FutureWarning)/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/transformers/training_args.py:1559: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:212: UserWarning: You passed a `packing` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:300: UserWarning: You passed a `max_seq_length` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:328: UserWarning: You passed a `dataset_text_field` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:334: UserWarning: You passed a `dataset_kwargs` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:300: UserWarning: You passed a `max_seq_length` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:328: UserWarning: You passed a `dataset_text_field` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:334: UserWarning: You passed a `dataset_kwargs` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:300: UserWarning: You passed a `max_seq_length` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:328: UserWarning: You passed a `dataset_text_field` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:334: UserWarning: You passed a `dataset_kwargs` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.  warnings.warn([2024-11-04 00:19:39,803] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)[2024-11-04 00:19:39,983] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)[2024-11-04 00:19:39,996] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)[2024-11-04 00:19:40,006] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)Using auto half precision backendPeftModelForCausalLM(  (base_model): LoraModel(    (model): LlamaForCausalLM(      (model): LlamaModel(        (embed_tokens): Embedding(128256, 8192)        (layers): ModuleList(          (0-79): 80 x LlamaDecoderLayer(            (self_attn): LlamaFlashAttention2(              (q_proj): lora.Linear4bit(                (base_layer): Linear4bit(in_features=8192, out_features=8192, bias=False)                (lora_dropout): ModuleDict(                  (default): Dropout(p=0.1, inplace=False)                )                (lora_A): ModuleDict(                  (default): Linear(in_features=8192, out_features=8, bias=False)                )                (lora_B): ModuleDict(                  (default): Linear(in_features=8, out_features=8192, bias=False)                )                (lora_embedding_A): ParameterDict()                (lora_embedding_B): ParameterDict()                (lora_magnitude_vector): ModuleDict()              )              (k_proj): lora.Linear4bit(                (base_layer): Linear4bit(in_features=8192, out_features=1024, bias=False)                (lora_dropout): ModuleDict(                  (default): Dropout(p=0.1, inplace=False)                )                (lora_A): ModuleDict(                  (default): Linear(in_features=8192, out_features=8, bias=False)                )                (lora_B): ModuleDict(                  (default): Linear(in_features=8, out_features=1024, bias=False)                )                (lora_embedding_A): ParameterDict()                (lora_embedding_B): ParameterDict()                (lora_magnitude_vector): ModuleDict()              )              (v_proj): lora.Linear4bit(                (base_layer): Linear4bit(in_features=8192, out_features=1024, bias=False)                (lora_dropout): ModuleDict(                  (default): Dropout(p=0.1, inplace=False)                )                (lora_A): ModuleDict(                  (default): Linear(in_features=8192, out_features=8, bias=False)                )                (lora_B): ModuleDict(                  (default): Linear(in_features=8, out_features=1024, bias=False)                )                (lora_embedding_A): ParameterDict()                (lora_embedding_B): ParameterDict()                (lora_magnitude_vector): ModuleDict()              )              (o_proj): lora.Linear4bit(                (base_layer): Linear4bit(in_features=8192, out_features=8192, bias=False)                (lora_dropout): ModuleDict(                  (default): Dropout(p=0.1, inplace=False)                )                (lora_A): ModuleDict(                  (default): Linear(in_features=8192, out_features=8, bias=False)                )                (lora_B): ModuleDict(                  (default): Linear(in_features=8, out_features=8192, bias=False)                )                (lora_embedding_A): ParameterDict()                (lora_embedding_B): ParameterDict()                (lora_magnitude_vector): ModuleDict()              )              (rotary_emb): LlamaRotaryEmbedding()            )            (mlp): LlamaMLP(              (gate_proj): lora.Linear4bit(                (base_layer): Linear4bit(in_features=8192, out_features=28672, bias=False)                (lora_dropout): ModuleDict(                  (default): Dropout(p=0.1, inplace=False)                )                (lora_A): ModuleDict(                  (default): Linear(in_features=8192, out_features=8, bias=False)                )                (lora_B): ModuleDict(                  (default): Linear(in_features=8, out_features=28672, bias=False)                )                (lora_embedding_A): ParameterDict()                (lora_embedding_B): ParameterDict()                (lora_magnitude_vector): ModuleDict()              )              (up_proj): lora.Linear4bit(                (base_layer): Linear4bit(in_features=8192, out_features=28672, bias=False)                (lora_dropout): ModuleDict(                  (default): Dropout(p=0.1, inplace=False)                )                (lora_A): ModuleDict(                  (default): Linear(in_features=8192, out_features=8, bias=False)                )                (lora_B): ModuleDict(                  (default): Linear(in_features=8, out_features=28672, bias=False)                )                (lora_embedding_A): ParameterDict()                (lora_embedding_B): ParameterDict()                (lora_magnitude_vector): ModuleDict()              )              (down_proj): lora.Linear4bit(                (base_layer): Linear4bit(in_features=28672, out_features=8192, bias=False)                (lora_dropout): ModuleDict(                  (default): Dropout(p=0.1, inplace=False)                )                (lora_A): ModuleDict(                  (default): Linear(in_features=28672, out_features=8, bias=False)                )                (lora_B): ModuleDict(                  (default): Linear(in_features=8, out_features=8192, bias=False)                )                (lora_embedding_A): ParameterDict()                (lora_embedding_B): ParameterDict()                (lora_magnitude_vector): ModuleDict()              )              (act_fn): SiLU()            )            (input_layernorm): LlamaRMSNorm((8192,), eps=1e-05)            (post_attention_layernorm): LlamaRMSNorm((8192,), eps=1e-05)          )        )        (norm): LlamaRMSNorm((8192,), eps=1e-05)        (rotary_emb): LlamaRotaryEmbedding()      )      (lm_head): Linear(in_features=8192, out_features=128256, bias=False)    )  ))trainable params: 103,546,880 || all params: 70,657,253,376 || trainable%: 0.1465trainable params: 103,546,880 || all params: 70,657,253,376 || trainable%: 0.1465trainable params: 103,546,880 || all params: 70,657,253,376 || trainable%: 0.1465trainable params: 103,546,880 || all params: 70,657,253,376 || trainable%: 0.1465/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/accelerate/accelerator.py:1584: UserWarning: Upcasted low precision parameters in Linear because mixed precision turned on in FSDP. Affects: weight.  warnings.warn(/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/accelerate/accelerator.py:1590: UserWarning: FSDP upcast of low precision parameters may affect the precision of model checkpoints.  warnings.warn(***** Running training *****  Num examples = 2,075  Num Epochs = 4  Instantaneous batch size per device = 4  Total train batch size (w. parallel, distributed & accumulation) = 32  Gradient Accumulation steps = 2  Total optimization steps = 260  Number of trainable parameters = 25,886,720Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.wandb: Currently logged in as: d0nnw0n9 (d0nnw0n9-rensselaer-polytechnic-institute). Use `wandb login --relogin` to force reloginwandb: Tracking run with wandb version 0.18.5wandb: Run data is saved locally in /home/wangd12/fin-llm/train/wandb/run-20241104_001954-sw4ostktwandb: Run `wandb offline` to turn off syncing.wandb: Syncing run llama-sft-qlora-fsdpwandb: ⭐️ View project at https://wandb.ai/d0nnw0n9-rensselaer-polytechnic-institute/huggingfacewandb: 🚀 View run at https://wandb.ai/d0nnw0n9-rensselaer-polytechnic-institute/huggingface/runs/sw4ostkt  0%|                                                                                                                                                                                                                              | 0/260 [00:00<?, ?it/s]/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]  0%|▊                                                                                                                                                                                                                  | 1/260 [01:44<7:30:44, 104.42s/it]  1%|█▋                                                                                                                                                                                                                  | 2/260 [03:10<6:42:29, 93.60s/it]  1%|██▍                                                                                                                                                                                                                 | 3/260 [04:37<6:27:11, 90.39s/it]  2%|███▎                                                                                                                                                                                                                | 4/260 [06:03<6:18:48, 88.78s/it]  2%|████                                                                                                                                                                                                                | 5/260 [07:29<6:13:31, 87.89s/it]  2%|████▉                                                                                                                                                                                                               | 6/260 [08:55<6:09:41, 87.33s/it]  3%|█████▋                                                                                                                                                                                                              | 7/260 [10:22<6:06:45, 86.98s/it]  3%|██████▌                                                                                                                                                                                                             | 8/260 [11:48<6:04:19, 86.74s/it]  3%|███████▎                                                                                                                                                                                                            | 9/260 [13:14<6:02:07, 86.56s/it]  4%|████████                                                                                                                                                                                                           | 10/260 [14:41<6:01:07, 86.67s/it]                                                                                                                                                                                                                                                           {'loss': 1.416, 'grad_norm': 0.11731761693954468, 'learning_rate': 9.96354437049027e-05, 'epoch': 0.15}  4%|████████                                                                                                                                                                                                           | 10/260 [14:41<6:01:07, 86.67s/it]  4%|████████▉                                                                                                                                                                                                          | 11/260 [16:07<5:59:21, 86.59s/it]  5%|█████████▋                                                                                                                                                                                                         | 12/260 [17:34<5:57:43, 86.55s/it]  5%|██████████▌                                                                                                                                                                                                        | 13/260 [19:00<5:56:11, 86.52s/it]  5%|███████████▎                                                                                                                                                                                                       | 14/260 [20:27<5:54:47, 86.54s/it]  6%|████████████▏                                                                                                                                                                                                      | 15/260 [21:53<5:53:14, 86.51s/it]  6%|████████████▉                                                                                                                                                                                                      | 16/260 [23:20<5:52:11, 86.61s/it]  7%|█████████████▊                                                                                                                                                                                                     | 17/260 [24:47<5:50:28, 86.54s/it]  7%|██████████████▌                                                                                                                                                                                                    | 18/260 [26:13<5:48:55, 86.51s/it]  7%|███████████████▍                                                                                                                                                                                                   | 19/260 [27:39<5:47:24, 86.49s/it]  8%|████████████████▏                                                                                                                                                                                                  | 20/260 [29:06<5:45:52, 86.47s/it]                                                                                                                                                                                                                                                           {'loss': 1.2872, 'grad_norm': 0.09869091212749481, 'learning_rate': 9.85470908713026e-05, 'epoch': 0.31}  8%|████████████████▏                                                                                                                                                                                                  | 20/260 [29:06<5:45:52, 86.47s/it]  8%|█████████████████                                                                                                                                                                                                  | 21/260 [30:32<5:44:13, 86.42s/it]  8%|█████████████████▊                                                                                                                                                                                                 | 22/260 [31:59<5:42:46, 86.41s/it]  9%|██████████████████▋                                                                                                                                                                                                | 23/260 [33:25<5:41:44, 86.52s/it]W1104 00:53:27.992000 140095794640192 torch/distributed/elastic/agent/server/api.py:688] Received 1 death signal, shutting down workersW1104 00:53:27.994000 140095794640192 torch/distributed/elastic/multiprocessing/api.py:858] Sending process 3622660 closing signal SIGHUPW1104 00:53:27.994000 140095794640192 torch/distributed/elastic/multiprocessing/api.py:858] Sending process 3622661 closing signal SIGHUPW1104 00:53:27.994000 140095794640192 torch/distributed/elastic/multiprocessing/api.py:858] Sending process 3622662 closing signal SIGHUPW1104 00:53:27.995000 140095794640192 torch/distributed/elastic/multiprocessing/api.py:858] Sending process 3622663 closing signal SIGHUPTraceback (most recent call last):  File "/home/wangd12/miniconda3/envs/finenv/bin/accelerate", line 8, in <module>    sys.exit(main())             ^^^^^^  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main    args.func(args)  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/accelerate/commands/launch.py", line 1155, in launch_command    multi_gpu_launcher(args)  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/accelerate/commands/launch.py", line 793, in multi_gpu_launcher    distrib_run.run(args)  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/distributed/run.py", line 892, in run    elastic_launch(  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 133, in __call__    return launch_agent(self._config, self._entrypoint, list(args))           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 255, in launch_agent    result = agent.run()             ^^^^^^^^^^^  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper    result = f(*args, **kwargs)             ^^^^^^^^^^^^^^^^^^  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py", line 680, in run    result = self._invoke_run(role)             ^^^^^^^^^^^^^^^^^^^^^^  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py", line 835, in _invoke_run    time.sleep(monitor_interval)  File "/home/wangd12/miniconda3/envs/finenv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 79, in _terminate_process_handler    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)torch.distributed.elastic.multiprocessing.api.SignalException: Process 3622651 got signal: 1